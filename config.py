"""
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Anki CSV Builder
"""

from typing import List, Dict, Tuple

# ==========================
# –ú–æ–¥–µ–ª–∏: –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫ + –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø–æ–¥–≥—Ä—É–∑–∫–∞ –∏–∑ API
# ==========================

DEFAULT_MODELS: List[str] = [
    "gpt-5",
    "gpt-5-mini",
    "gpt-5-nano",
    "gpt-4.1",
    "gpt-4o",
    "gpt-4o-mini",
    "o3-mini",
]

_PREFERRED_ORDER: Dict[str, int] = {  # —á–µ–º –º–µ–Ω—å—à–µ —á–∏—Å–ª–æ ‚Äî —Ç–µ–º –≤—ã—à–µ –≤ —Å–ø–∏—Å–∫–µ
    "gpt-5": 0,
    "gpt-5-mini": 1,
    "gpt-5-nano": 2,
    "gpt-4.1": 3,
    "gpt-4o": 4,
    "gpt-4o-mini": 5,
    "o3": 6,
    "o3-mini": 7,
}

# –ú–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–∫–ª—é—á–∞–µ–º –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ –≤ ID (–Ω–∞–º –Ω—É–∂–µ–Ω –∏–º–µ–Ω–Ω–æ —Ç–µ–∫—Å—Ç-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä)
_BLOCK_SUBSTRINGS: Tuple[str, ...] = (
    "audio", "realtime",           # gpt-4o-audio-*, gpt-4o-realtime-*
    "embed", "embedding",          # text-embedding-*
    "whisper", "asr", "transcribe", "speech", "tts",  # ASR/TTS
    "moderation",                  # –º–æ–¥–µ—Ä–∞—Ü–∏—è
    "search",                      # –ø–æ–∏—Å–∫–æ–≤—ã–µ/–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ
    "vision", "vision-preview",    # —á–∏—Å—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ/–ø—Ä–µ–≤—å—é
    "distill", "distilled",        # –¥–∏—Å—Ç–∏–ª–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–µ—Ü-–º–æ–¥–µ–ª–∏
    "batch", "preview"             # —Å–ª—É–∂–µ–±–Ω—ã–µ/–ø—Ä–µ–≤—å—é/–±–∞—Ç—á–µ–≤—ã–µ
)

# –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ —Å–µ–º–µ–π—Å—Ç–≤–∞ (–ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É) –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
_ALLOWED_PREFIXES: Tuple[str, ...] = ("gpt-5", "gpt-4.1", "gpt-4o", "o3")

# ==========================
# –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
# ==========================

PROMPT_SYSTEM: str = (
    "–¢—ã ‚Äî –æ–ø—ã—Ç–Ω—ã–π –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ NL‚ÜíRU –∏ –∞–≤—Ç–æ—Ä —É—á–µ–±–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤. "
    "–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –°–¢–†–û–ì–û JSON-–æ–±—ä–µ–∫—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ Anki —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π: "
    "{woord, cloze_sentence, ru_sentence, collocaties, def_nl, ru_short}.\n"
    "–û–ë–©–ò–ï –ü–†–ê–í–ò–õ–ê (–û–ß–ï–ù–¨ –í–ê–ñ–ù–û):\n"
    "‚Ä¢ –í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û JSON –ë–ï–ó –ø–æ—è—Å–Ω–µ–Ω–∏–π –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.\n"
    "‚Ä¢ –ù–ò –û–î–ù–û –ø–æ–ª–µ –Ω–µ –ø—É—Å—Ç–æ–µ. –ó–∞–ø—Ä–µ—â–µ–Ω—ã –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏.\n"
    "‚Ä¢ –°–∏–º–≤–æ–ª '|' –≤ —Ç–µ–∫—Å—Ç–∞—Ö –∑–∞–ø—Ä–µ—â—ë–Ω.\n"
    "‚Ä¢ –ï—Å–ª–∏ –¥–∞–Ω–æ def_nl ‚Äî —Å—Ç—Ä–æ–≥–æ —Å–ª–µ–¥—É–π –µ–º—É; –Ω–µ –º–µ–Ω—è–π –±–∞–∑–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–æ–≤–∞.\n"
    "‚Ä¢ –°–æ—Ö—Ä–∞–Ω—è–π —á–∞—Å—Ç—å —Ä–µ—á–∏: ru_short –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —á–∞—Å—Ç–∏ —Ä–µ—á–∏ —Å–ª–æ–≤–∞ "
    "(–≥–ª–∞–≥–æ–ª‚Üí–∏–Ω—Ñ–∏–Ω–∏—Ç–∏–≤; —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ‚Üí—Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ; –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ‚Üí–ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ).\n"
    "‚Ä¢ ru_sentence ‚Äî –¢–û–ß–ù–´–ô –ø–µ—Ä–µ–≤–æ–¥ NL-–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –±–µ–∑ –ø–µ—Ä–µ—Ñ—Ä–∞–∑–∞.\n"
    "‚Ä¢ cloze_sentence ‚Äî –æ–¥–Ω–æ –∫–æ—Ä–æ—Ç–∫–æ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ NL-–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ (8‚Äì14 —Å–ª–æ–≤, –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è, "
    "–±–µ–∑ –∏–º—ë–Ω/—Ü–∏—Ñ—Ä/–∫–∞–≤—ã—á–µ–∫); —Ü–µ–ª–µ–≤–æ–µ —Å–ª–æ–≤–æ –≤–Ω—É—Ç—Ä–∏ {{c1::‚Ä¶}}.\n"
    "  –ï—Å–ª–∏ —Å–ª–æ–≤–æ ‚Äî —Ä–∞–∑–¥–µ–ª–∏–º—ã–π –≥–ª–∞–≥–æ–ª: {{c1::stam}} ‚Ä¶ {{c2::partikel}}. –ò–Ω–∞—á–µ —Ç–æ–ª—å–∫–æ {{c1::‚Ä¶}}.\n"
    "‚Ä¢ collocaties ‚Äî –†–û–í–ù–û 3 —á–∞—Å—Ç–æ—Ç–Ω—ã–µ —Å–≤—è–∑–∫–∏, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å '; ' (—Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π –∏ –ø—Ä–æ–±–µ–ª).\n"
    "  –ö–∞–∂–¥–∞—è —Å–≤—è–∑–∫–∞ ‚Äî 2‚Äì3 —Å–ª–æ–≤–∞ —Å —Ü–µ–ª–µ–≤—ã–º —Å–ª–æ–≤–æ–º –≤ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ñ–æ—Ä–º–µ. –ù–µ–ª—å–∑—è: –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –ø–∞—Ä—ã "
    "(–Ω–∞–ø—Ä–∏–º–µ—Ä, 'een grote caissi√®re'), —Ä–µ–¥–∫–∏–µ/–∫–Ω–∏–∂–Ω—ã–µ, –∏–º–µ–Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ.\n"
    "‚Ä¢ –ò–∑–±–µ–≥–∞–π —Ä–µ–¥–∫–æ–π –ª–µ–∫—Å–∏–∫–∏; –∏—Å–ø–æ–ª—å–∑—É–π A2‚ÄìB1 –≤–æ–∫—Ä—É–≥ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞.\n\n"
    "–§–û–†–ú–ê–¢ –í–´–í–û–î–ê: –æ–¥–∏–Ω JSON-–æ–±—ä–µ–∫—Ç —Å –∫–ª—é—á–∞–º–∏: woord, cloze_sentence, ru_sentence, collocaties, def_nl, ru_short.\n\n"
    "–ü–†–ò–ú–ï–†–´ (—Å—Ç–∏–ª—å, –ù–ï –∫–æ–ø–∏—Ä—É–π —Å–ª–æ–≤–∞):\n"
    "// –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ\n"
    "{\"woord\": \"boodschap\", \"cloze_sentence\": \"Hij doet elke dag de {{c1::boodschap}}.\", "
    "\"ru_sentence\": \"–û–Ω –¥–µ–ª–∞–µ—Ç –ø–æ–∫—É–ø–∫–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.\", "
    "\"collocaties\": \"boodschappen doen; een boodschap doorgeven; een duidelijke boodschap\", "
    "\"def_nl\": \"iets wat je wilt zeggen of inkopen die je doet\", \"ru_short\": \"–ø–æ–∫—É–ø–∫–∞; –ø–æ—Å–ª–∞–Ω–∏–µ\"}\n"
    "// –†–∞–∑–¥–µ–ª–∏–º—ã–π –≥–ª–∞–≥–æ–ª\n"
    "{\"woord\": \"opruimen\", \"cloze_sentence\": \"Na het eten {{c1::ruimt}} hij de tafel {{c2::op}}.\", "
    "\"ru_sentence\": \"–ü–æ—Å–ª–µ –µ–¥—ã –æ–Ω —É–±–∏—Ä–∞–µ—Ç —Å–æ —Å—Ç–æ–ª–∞.\", "
    "\"collocaties\": \"de kamer opruimen; speelgoed opruimen; netjes opruimen\", "
    "\"def_nl\": \"iets op zijn plaats leggen zodat het netjes is\", \"ru_short\": \"—É–±–∏—Ä–∞—Ç—å\"}\n"
    "// –ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ\n"
    "{\"woord\": \"streng\", \"cloze_sentence\": \"De docent is vandaag {{c1::streng}}.\", "
    "\"ru_sentence\": \"–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å —Å–µ–≥–æ–¥–Ω—è —Å—Ç—Ä–æ–≥–∏–π.\", "
    "\"collocaties\": \"strenge regels; een strenge docent; streng optreden\", "
    "\"def_nl\": \"met veel eisen en weinig toelating\", \"ru_short\": \"—Å—Ç—Ä–æ–≥–∏–π\"}"
)

# ==========================
# –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
# ==========================

DEMO_WORDS: List[Dict[str, str]] = [
    {"woord": "aanraken", "def_nl": "iets met je hand of een ander deel van je lichaam voelen"},
    {"woord": "begrijpen", "def_nl": "snappen wat iets betekent of inhoudt"},
    {"woord": "gillen", "def_nl": "hard en hoog schreeuwen"},
    {"woord": "kloppen", "def_nl": "met regelmaat bonzen of tikken"},
    {"woord": "toestaan", "def_nl": "goedkeuren of laten gebeuren"},
    {"woord": "opruimen", "def_nl": "iets netjes maken door het op zijn plaats te leggen"},
]

# ==========================
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ UI
# ==========================

PAGE_TITLE: str = "Anki CSV Builder"
PAGE_LAYOUT: str = "wide"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ temperature slider
TEMPERATURE_MIN: float = 0.2
TEMPERATURE_MAX: float = 0.8
TEMPERATURE_DEFAULT: float = 0.4
TEMPERATURE_STEP: float = 0.1

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ CSV
CSV_DELIMITER: str = '|'
CSV_LINETERMINATOR: str = '\n'

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
PREVIEW_LIMIT: int = 20

# –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É API –∑–∞–ø—Ä–æ—Å–∞–º–∏ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)
API_REQUEST_DELAY: float = 0.1

# ==========================
# –ó–∞–≥–æ–ª–æ–≤–∫–∏ CSV
# ==========================

CSV_HEADERS: List[str] = [
    "NL-—Å–ª–æ–≤–æ",
    "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ NL (—Å cloze)",
    "–ü–µ—Ä–µ–≤–æ–¥ RU",
    "–ö–æ–ª–ª–æ–∫–∞—Ü–∏–∏",
    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ NL",
    "–ü–µ—Ä–µ–≤–æ–¥ —Å–ª–æ–≤–∞ RU",
]

# ==========================
# –°–æ–æ–±—â–µ–Ω–∏—è –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏
# ==========================

MESSAGES = {
    "demo_loaded": "üîÅ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-–Ω–∞–±–æ—Ä –∏–∑ 6 —Å–ª–æ–≤",
    "no_api_key": "–£–∫–∞–∂–∏ OPENAI_API_KEY –≤ Secrets –∏–ª–∏ –≤ –ø–æ–ª–µ —Å–ª–µ–≤–∞.",
    "temperature_unavailable": "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —ç—Ç–æ–π –º–æ–¥–µ–ª–∏; –æ–Ω–∞ –±—É–¥–µ—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∞.",
    "help_temperature": "–õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ ‚Äî gpt-5 (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω); –±–∞–ª–∞–Ω—Å ‚Äî gpt-4.1; –±—ã—Å—Ç—Ä–µ–µ/–¥–µ—à–µ–≤–ª–µ ‚Äî gpt-4o / gpt-5-mini.",
    "help_stream": "Streaming –≤ Responses API: —Ñ–∏–Ω–∞–ª—å–Ω—ã–π JSON –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å—Ç—Ä–∏–º–∞",
    "placeholder_custom_model": "–Ω–∞–ø—Ä–∏–º–µ—Ä, gpt-5-2025-08-07",
    "footer_tips": (
        "–°–æ–≤–µ—Ç—ã: 1) –¥–æ–±–∞–≤–ª—è–π –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ NL-–¥–µ—Ñ–∏–Ω–∏—Ü–∏–∏ –≤–æ –≤—Ö–æ–¥ ‚Äî —ç—Ç–æ —É–ª—É—á—à–∏—Ç –ø—Ä–∏–º–µ—Ä—ã; "
        "2) –µ—Å–ª–∏ –≤–∏–¥–∏—à—å —Å—Ç—Ä–∞–Ω–Ω—ã–µ –∫–æ–ª–ª–æ–∫–∞—Ü–∏–∏ ‚Äî –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–ª–æ–≤–∞, "
        "3) —Å–∏–º–≤–æ–ª '|' –≤ —Ç–µ–∫—Å—Ç–∞—Ö –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ '‚à£'."
    )
}

# ==========================
# –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
# ==========================

def get_preferred_order() -> Dict[str, int]:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –º–æ–¥–µ–ª–µ–π"""
    return _PREFERRED_ORDER.copy()

def get_block_substrings() -> Tuple[str, ...]:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –ø–æ–¥—Å—Ç—Ä–æ–∫"""
    return _BLOCK_SUBSTRINGS

def get_allowed_prefixes() -> Tuple[str, ...]:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤"""
    return _ALLOWED_PREFIXES
